language: r

addons:
  postgresql: "9.6"

before_install:
  ## install gdal and proj4 from ubuntugis ppa (inspired from github.com/jannes-m/RQGIS/)
  # 2. remove postgresql installs which create some error otherwise
  #- sudo apt-get remove -y postgresql-9.*
  #- sudo apt autoremove
  # 3. install riak which creates some error otherwise
  - sudo DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::="--force-confdef" -o Dpkg::Options::="--force-confnew" install riak
  # 4. add GIS repos
  - sudo add-apt-repository -y ppa:ubuntugis/ubuntugis-unstable
  # 5. refresh
  - sudo apt update -y
  - sudo apt upgrade -y
  - sudo apt autoremove
  # 6. install gdal
  - sudo apt install -y gdal-bin libgdal-dev python-gdal python3-gdal
  ## go to the IsoirX folder
  - cd IsoriX

before_script:
  - Rscript -e 'install.packages("rgdal", type = "source")'

cache: packages

r:
  - release
  - devel
  
r_check_args: 
  --as-cran

r_packages:
  - covr
  
after_success:
  - Rscript -e 'library(covr); codecov(type = "examples")'
